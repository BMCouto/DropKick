/*! DropKick: https://github.com/JamieLottering/DropKick */
(function(g,f,y){var h=false,v={},r={enter:13,esc:27,left:37,up:38,right:39,down:40},x=['<div class="dk_container dk_class_{{ id }} {{ theme }}" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">','<a class="dk_toggle" style="width: {{ width }};">','<span class="dk_label">{{ label }}</span>',"</a>",'<div class="dk_options">','<ul class="dk_options_inner">',"{{ inner }}","</ul>","</div>","</div>"].join(""),w=['<li class="{{ current }}">','<a data-dk-dropdown-value="{{ value }}">{{ text }}</a>',"</li>"].join(""),o={open:"dk_open",focus:"dk_focus",container:"dk_container",toggle:"dk_toggle",label:"dk_label",current:"dk_option_current",selected:"dk_option_selected",dropdown:"dk_options",menu:"dk_options_inner",options:"dk_options"},e="dk:event",p={close:"dk:close",change:"dk:change",load:"dk:load",reset:"dk:reset",open:"dk:open"},l={speed:1000,theme:"dk_theme_default",change:g.noop,close:c,open:i,load:g.noop};function i(){this.show()}function c(){this.hide()}g(function(){g("."+o.container).live(e,function(A,z){n.call(g(this),A,z)}).live("focus.dk",function(z){g(this).addClass(o.focus)});g("."+o.toggle).live("mousedown",function(A){var z=g(this).parents(".dk_container").first();if(z.hasClass(o.open)){s(z)}else{d(z)}A.preventDefault();return false});g("."+o.options).find("a").live("click",function(z){k(g(this),g(this).parents("."+o.container).first());z.preventDefault();return false});g("label[for]").live("click",function(A){var z=g("#dk_container_"+g(this).attr("for"));if(z.length){z.focus()}});g(document).bind("keydown.dk_nav",function(B){var C=g(".dk_container.dk_open"),A=g(".dk_container.dk_focus"),z=null;if(C.length){z=C}else{if(A.length&&!C.length){z=A}}if(z){u(B,z)}}).bind("click.dropkick",function(A){var z=g(A.target);if(!z.parents("."+o.container).length&&g("."+o.open).length){t()}})});function u(H,F){var z=H.keyCode,C=F.data("dropkick"),K=F.find(".dk_options"),G=F.hasClass("dk_open"),I=F.find(".dk_option_current a"),A=I.parent(),E=K.find("li").first(),J=K.find("li").last(),D,B;switch(z){case r.enter:if(G){k(I,F)}else{d(F)}H.preventDefault();break;case r.up:B=A.prev("li");if(G){if(B.length){q(B,F)}else{q(J,F)}}else{d(F)}H.preventDefault();break;case r.down:if(G){D=A.next("li").first();if(D.length){q(D,F)}else{q(E,F)}}else{d(F)}H.preventDefault();break;case r.esc:if(G){s(F);H.preventDefault()}break}}function n(z,A){var B=(typeof A.cb==="function")?A.cb:g.noop;switch(A.event){case p.close:B.call(this.find("."+o.options),z);this.removeClass(o.open);break;case p.open:B.call(this.find("."+o.options),z);this.addClass(o.open);break;case p.load:this.fadeIn(A.speed);B.call(this,z);break;case p.change:B.call(this,A.value,A.label);break}}function s(z){var A=z.data("dropkick:callbacks");z.trigger(e,[{event:p.close,cb:A.close}])}function d(z){var A=z.data("dropkick:callbacks");if(g(".dk_focus").length){g(".dk_focus").not(z).removeClass(o.focus)}if(g(".dk_open").length){t()}z.trigger(e,[{event:p.open,cb:A.open}]);m(z.find(".dk_option_selected"),z)}function t(){g(".dk_open").each(function(){s(g(this))})}function m(B,A){var z=A.find("."+o.menu);var C=B.prevAll("li").length*B.prevAll("li").outerHeight();if(typeof C==="number"){z.animate({scrollTop:C+"px"},0)}}function q(z,A){A.find("."+o.current).removeClass(o.current);z.addClass(o.current);m(z,A)}function b(z,A){A.find("."+o.label).text(z)}function j(A,z){var B=z.data("dropkick").selectEl;B.val(A)}function k(B,A){var C=A.data("dropkick:callbacks"),z=B.text(),D=B.attr("data-dk-dropdown-value");b(z,A);j(D,A);q(B.parent(),A);s(A);A.trigger(e,[{event:p.change,value:D,label:z,cb:C.change}])}function a(F,H){var E=F,z=[],I=H.options,D;E=E.replace(/{{ id }}/g,H.id);E=E.replace("{{ label }}",H.label);E=E.replace("{{ tabindex }}",H.tabindex);E=E.replace("{{ width }}",H.width);E=E.replace("{{ theme }}",H.theme);if(I&&I.length){for(var C=0,A=I.length;C<A;C++){var B=g(I[C]),G=[o.current,o.selected].join(" "),F=w;F=F.replace("{{ value }}",B.val());F=F.replace("{{ current }}",(B.val()===H.original)?G:"");F=F.replace("{{ text }}",B.text());z[z.length]=F}}z=E.replace("{{ inner }}",z.join(""));return z}v.init=function(z){z=g.extend({},l,z);return this.each(function(){console.time("dk_");if(g(this).data("dropkick")&&g(this).data("dropkick").id){return g(this)}var C=g(this),E=C.parents("form").length?C.parents("form").first():null,D=C.find(":selected")||C.find("option").first(),A=C.attr("name")||C.attr("id"),F=C.attr("tabindex")||"1",M=C.find("option"),H=C.data("dropkick")||{},B=z.width||C.outerWidth(),L={},G=(z.theme===l.theme)?l.theme:"dk_theme_"+z.theme,K={change:z.change,load:z.load,open:z.open,close:z.close},J,I;H.selectEl=C;H.original=D;H.id=A;H.parentForm=E;L.tabindex=F;L.label=D.text();L.id=A;L.options=M;L.original=D.val();L.width=B+"px";L.theme=G;I=g(a(x,L));C.before(I);C.fadeOut(100,function(){C.data("dropkick",H);I.data("dropkick",H);I.data("dropkick:callbacks",K);I.bind("blur.dk",function(N){g(this).removeClass(o.focus)});I.trigger(e,[{event:p.load,cb:z.load,speed:z.speed}])});return C})};v.reset=function(){var A=g(this),z=A.data("dropkick").parentForm.find("."+o.container);z.each(function(){var B=g(this),C=B.find(".dk_option_selected");k(C,B);q(C,B)})};g.fn.dropkick=function(z){if(!h){if(v[z]){return v[z].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof z==="object"||!z){return v.init.apply(this,arguments)}}}}})(jQuery,window,document);